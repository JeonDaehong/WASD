<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WASD Game</title>
    <script src="phaser/phaser.js"></script>
    <script src="plugins/SpinePluginDebug.js"></script>
    <link rel="stylesheet" type="text/css" href="wasd.css">
</head>
<body>
    <div class="header">
        <div>
            <span class="title_Span">WASD Game</span>
        </div>
    </div>
    <div class="body">
        <div id="wasd"></div>
    </div>
    <script>

        // 로딩 이미지 스파인 오브젝트
        class Loading
        {
            constructor (scene, x, y, key, animationName, loop)
            {
                this.scene = scene;

                this.spine = scene.add.spine(x, y, key, animationName, loop);
            }
        }

        // 로딩 텍스트 스파인 오브젝트
        class Loading_Text
        {
            constructor (scene, x, y, key, animationName, loop)
            {
                this.scene = scene;

                this.spine = scene.add.spine(x, y, key, animationName, loop);
            }
        }

        class CustomSpineObject2
        {
            constructor (scene, x, y, key, animationName, loop)
            {
                this.scene = scene;

                this.spine = scene.make.spine({ scene, x, y, key, animationName, loop });

                scene.sys.displayList.add(this.spine);
                scene.sys.updateList.add(this.spine);
            }
        }

        class CustomSpineObject3
        {
            constructor (scene, x, y, key, animationName, loop)
            {
                this.scene = scene;

                this.parent = scene.add.container(0, 0);

                this.spine = scene.make.spine({ scene, x, y, key, animationName, loop });

                this.parent.add(this.spine);
            }
        }

        // 1. 로고 Scene
        class WASD_LOGO extends Phaser.Scene {
        
            constructor ()
            {
                super
                ({
                    key: 'WASD_LOGO'
                });
            }
        
            preload ()
            {
                this.load.image('logo', 'img/wasd_logo.png'); // logo image preload
            }
        
            create ()
            {
                let logo = this.add.image(400, 300, 'logo'); // logo image create
        
                // logo image width, height amend
                logo.displayWidth = 400;
                logo.displayHeight = 300;
        
                // fade in
                this.cameras.main.fadeIn(1200, 0, 0, 0);
        
                // 2초 후 fade out
                setTimeout(() => this.cameras.main.fadeOut(1200, 0, 0, 0), 2000);
        
                this.time.addEvent({
                    delay: 3000,
                    loop: false,
                    callback: () => {
                        this.scene.start("WASD_LOADING");
                    }
                });
            }
        
        }
        
        

        // 2. 로딩 Scene
        class WASD_LOADING extends Phaser.Scene
        {
            constructor ()
            {
                super
                ({
                    key: 'WASD_LOADING',
                    pack: {
                        files: [
                            {type: 'scenePlugin', key: 'SpinePlugin', url: 'plugins/SpinePluginDebug.js', sceneKey: 'spine'}
                        ]
                    }
                });
            }

            preload ()
            {
                this.load.setPath('assets/LOADING_SPINE/');
                this.load.spine('Loading', 'Loading.json', ['Loading.atlas'], true);

                this.load.setPath('assets/LOADING_TEXT/');
                this.load.spine('Loading_Text', 'Loading_TEXT.json', ['Loading_TEXT.atlas'], true);
            }

            create ()
            {
                let loadingSpine = new Loading(this, 400, 200, 'Loading.loading', 'animation', true);
                let loadingTextSpine = new Loading_Text(this, 400, 400, 'Loading_Text.loading', 'animation', true);
            }
        }

        // Main Game (WASD)
        const gameConfig = {
            type: Phaser.AUTO,
            parent: "wasd",
            width: 800,
            height: 600,
            backgroundColor: "black",
            scene: [
                WASD_LOGO,
                WASD_LOADING
            ],
            autoCenter: Phaser.Scale.CENTER_BOTH // Phaser Canvas를 Center에 위치.
        };

        // 게임 불러오기
        const game = new Phaser.Game(gameConfig);

    </script>
    <div class="footer">

    </div>
</body>
</html>